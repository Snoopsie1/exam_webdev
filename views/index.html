% include('_header.html', title='Welcome')

<main class="flex pt-16">
	<div class="w-full h-full">
		<div class="fixed w-[calc(50%-0.5rem)] h-[calc(100%-5rem)] bg-neutral-100">
			<div id="map" class="w-full h-full rounded-lg"></div>
			<script>
				mapboxgl.accessToken = '{{mapbox_token}}';
				var map = new mapboxgl.Map({
					container: 'map',
					style: 'mapbox://styles/mapbox/streets-v11',
					center: [12.5683, 55.6761],
					zoom: 12,
				});

				var properties = '{{properties}}'.replace(/&#039;/g, '"');
				properties = JSON.parse(properties);

				var markers = [];

				for (let index = 0; index < properties.length; index++) {
					console.log(properties[index].property_lat);

					var marker = new mapboxgl.Marker()
						.setLngLat([
							properties[index].property_lat,
							properties[index].property_lon,
						])
						.addTo(map);

					markers.push(marker);

					console.log('Markers', markers);
				}
			</script>
		</div>
	</div>
	<div class="w-full pb-16 px-4">
		<div id="property" class="grid grid-cols-3 gap-3 mt-3">
			% for property in properties:
			  % if property['property_is_blocked'] != '1' or is_admin: 
          		% include("_property")
			  % end
			% end
		</div>
		<button
			id="more"
			class="block w-1/3 text-white bg-dragon-fruit mx-auto m-4"
			mix-get="/properties/page/2"
			mix-default="more"
			mix-await="Please wait..."
		>
			Load more
		</button>
	</div>
</main>

% include('_footer.html')
